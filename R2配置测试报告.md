# R2é…ç½®æµ‹è¯•æŠ¥å‘Š

## âœ… æµ‹è¯•ç»“æœ

**æµ‹è¯•æ—¶é—´**: 2026-02-07 05:55:01  
**æµ‹è¯•ç»“æœ**: âœ… **æˆåŠŸ**

## ğŸ” å‘ç°çš„é—®é¢˜

### 1. R2 Workerç«¯ç‚¹é”™è¯¯
- **é”™è¯¯é…ç½®**: `https://khjghjghjjh.xyz/api/upload`
- **æ­£ç¡®é…ç½®**: `https://khjghjghjjh.xyz/upload`
- **é—®é¢˜**: `/api/upload` ç«¯ç‚¹åªæ”¯æŒ GET å’Œ DELETE æ–¹æ³•ï¼Œä¸æ”¯æŒ POST
- **è§£å†³**: å·²æ›´æ–°ä¸º `/upload` ç«¯ç‚¹

### 2. Content-Typeæ˜ å°„é—®é¢˜
- **é—®é¢˜**: ä»£ç ä½¿ç”¨ `image/jpg` ä½œä¸ºContent-Typeï¼Œä½†R2 Workerä¸æ¥å—
- **åŸå› **: R2 Workerè¦æ±‚ä½¿ç”¨ `image/jpeg` è€Œä¸æ˜¯ `image/jpg`
- **è§£å†³**: å·²æ·»åŠ æ‰©å±•ååˆ°Content-Typeçš„æ˜ å°„é€»è¾‘
  - `jpg` â†’ `jpeg`
  - `png` â†’ `png`
  - `gif` â†’ `gif`
  - `webp` â†’ `webp`
  - `avif` â†’ `avif`

## ğŸ“‹ R2 Workeræ”¯æŒçš„æ–‡ä»¶ç±»å‹

æ ¹æ®é”™è¯¯å“åº”ï¼ŒR2 Workeræ”¯æŒä»¥ä¸‹æ–‡ä»¶ç±»å‹ï¼š

**å›¾ç‰‡**:
- `image/jpeg`
- `image/png`
- `image/gif`
- `image/webp`
- `image/avif`

**è§†é¢‘**:
- `video/mp4`
- `video/webm`
- `application/x-mpegURL`
- `application/vnd.apple.mpegurl`
- `video/mp2t` (TSæ–‡ä»¶)

**éŸ³é¢‘**:
- `audio/mp3`
- `audio/wav`
- `audio/mpeg`
- `audio/mp4`
- `audio/aac`
- `audio/x-m4a`
- `audio/ogg`
- `audio/opus`
- `audio/amr`

**å…¶ä»–**:
- `text/plain`

## âœ… æµ‹è¯•ç»“æœ

### æµ‹è¯•ç”¨ä¾‹1: ä¸Šä¼ PNGå›¾ç‰‡
- **çŠ¶æ€**: âœ… æˆåŠŸ
- **Resource Key**: `uploads/1770443707852_4eb1fee4_uploads_test_test_image.png`
- **URL**: `/uploads/1770443707852_4eb1fee4_uploads_test_test_image.png`

## ğŸ”§ å·²æ›´æ–°çš„é…ç½®

### 1. `config/default.json`
```json
{
  "r2WorkerUrl": "https://khjghjghjjh.xyz/upload"
}
```

### 2. `src/js/configManager.js`
```javascript
{
  r2WorkerUrl: 'https://khjghjghjjh.xyz/upload'
}
```

### 3. `crawler/r2Uploader.js`
- æ·»åŠ äº†æ‰©å±•ååˆ°Content-Typeçš„æ˜ å°„é€»è¾‘
- ä»filenameä¸­æå–æ‰©å±•åå¹¶æ­£ç¡®æ˜ å°„
- ä¿®å¤äº† `jpg` â†’ `jpeg` çš„æ˜ å°„

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ç«¯ç‚¹è·¯å¾„**: å¿…é¡»ä½¿ç”¨ `/upload` è€Œä¸æ˜¯ `/api/upload`
2. **Content-Type**: å¿…é¡»ä½¿ç”¨æ­£ç¡®çš„MIMEç±»å‹ï¼ˆå¦‚ `image/jpeg` è€Œä¸æ˜¯ `image/jpg`ï¼‰
3. **æ–‡ä»¶ç±»å‹**: åªèƒ½ä¸Šä¼ R2 Workeræ”¯æŒçš„æ–‡ä»¶ç±»å‹
4. **è·¯å¾„æ ¼å¼**: ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ä¼šè‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³å’ŒUUIDå‰ç¼€

## ğŸ¯ ä¸‹ä¸€æ­¥

ç°åœ¨R2é…ç½®å·²æ­£ç¡®ï¼Œå¯ä»¥ï¼š
1. âœ… æ­£å¸¸ä¸Šä¼ å›¾ç‰‡åˆ°R2
2. âœ… æ­£å¸¸ä¸Šä¼ è§†é¢‘åˆ°R2
3. âœ… æ­£å¸¸ä¸Šä¼ TSæ–‡ä»¶åˆ°R2
4. âœ… åœ¨åŒæ­¥æµç¨‹ä¸­ä½¿ç”¨R2ä¸Šä¼ åŠŸèƒ½
